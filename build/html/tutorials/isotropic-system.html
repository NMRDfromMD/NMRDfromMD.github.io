<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../_static/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Anisotropic systems" href="anisotropic-system.html" /><link rel="prev" title="Installation" href="installation.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Isotropic systems - </title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=22d2b077" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">    </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo-b.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">    </span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/NMR.html">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/utilities.html">Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Isotropic systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="anisotropic-system.html">Anisotropic systems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Illustrations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../illustrations/lennard-jones-fluids.html">Lennard-Jones fluid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../illustrations/bulk-water.html">Bulk water</a></li>
<li class="toctree-l1"><a class="reference internal" href="../illustrations/lysozyme-in-water.html">Lysozyme in water</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../theory/context.html">Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/dipolar_relaxation.html">Dipolar relaxation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/best-practice.html">Best practice</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../additional/bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../additional/acknowledgments.html">Acknowledgments</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorials/isotropic-system.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="isotropic-systems">
<span id="isotropic-label"></span><h1>Isotropic systems<a class="headerlink" href="#isotropic-systems" title="Link to this heading">¶</a></h1>
<div class="justify docutils container">
<p>In this tutorial, the NMR relaxation times <span class="math notranslate nohighlight">\(T_1\)</span> and <span class="math notranslate nohighlight">\(T_2\)</span>
are measured from a bulk polymer-water mixture using <a href="https://nmrformd.readthedocs.io" target="_blank">NMRforMD</a>.
To follow the tutorial, <a href="https://www.mdanalysis.org" target="_blank">MDAnalysis</a>,
<a href="https://www.numpy.org" target="_blank">numpy</a>, and
<a href="https://www.matplotlib.org" target="_blank">matplotlib</a> must be installed.</p>
</div>
<section id="md-system">
<h2>MD system<a class="headerlink" href="#md-system" title="Link to this heading">¶</a></h2>
<div class="hatnote docutils container">
<p>Measuring the NMR relaxation time from a bulk water-polymer mixture</p>
</div>
<a class="only-dark reference internal image-reference" href="../_images/snapshot-dark3.png"><img alt="PEG-water mixture simulated with LAMMPS - Dipolar NMR relaxation time calculation" class="only-dark align-right" src="../_images/snapshot-dark3.png" style="width: 250px;" />
</a>
<a class="only-light reference internal image-reference" href="../_images/snapshot-light3.png"><img alt="PEG-water mixture simulated with LAMMPS - Dipolar NMR relaxation time calculation" class="only-light align-right" src="../_images/snapshot-light3.png" style="width: 250px;" />
</a>
<div class="justify docutils container">
<p>The system is made of a bulk mixture of 320 <span class="math notranslate nohighlight">\(\text{TIP4P}-\epsilon\)</span> water molecules
and 32 <span class="math notranslate nohighlight">\(\text{PEG}300\)</span> polymer molecules. The trajectory was recorded
during a <span class="math notranslate nohighlight">\(10\,\text{ns}\)</span> production run performed with the open source code LAMMPS
in the NPT ensemble using a timestep of <span class="math notranslate nohighlight">\(1\,\text{fs}\)</span>.
The imposed was temperature <span class="math notranslate nohighlight">\(T = 300\,^\circ\text{K}\)</span>, and the pressure
<span class="math notranslate nohighlight">\(p = 1\,\text{atm}\)</span>. The positions of the atoms were recorded in
the <em>prod.xtc</em> file
every <span class="math notranslate nohighlight">\(1\,\text{ps}\)</span>.</p>
</div>
<div class="justify docutils container">
<p>If you are not familiar with LAMMPS, you can find <a href="https://lammpstutorials.github.io/" target="_blank">tutorials</a> here.</p>
</div>
</section>
<section id="file-preparation">
<h2>File preparation<a class="headerlink" href="#file-preparation" title="Link to this heading">¶</a></h2>
<div class="justify docutils container">
<p>To access all trajectory and input files, download
the <em>polymer-in-water</em> repository from Github, or simply
clone it on your computer using:</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/simongravelle/polymer-in-water.git
</pre></div>
</div>
<div class="justify docutils container">
<p>The dataset required to follow this tutorial is located
in <em>raw-data/NPEG32/</em>.</p>
</div>
</section>
<section id="create-a-mdanalysis-universe">
<h2>Create a MDAnalysis universe<a class="headerlink" href="#create-a-mdanalysis-universe" title="Link to this heading">¶</a></h2>
<div class="justify docutils container">
<p>Open a new Python script or a new notebook, and define
the path to the data files:</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">datapath</span> <span class="o">=</span> <span class="s2">&quot;mypath/polymer-in-water/raw-data/NPEG32/&quot;</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Then, import numpy, MDAnalysis, and NMRforMD:</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">MDAnalysis</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mda</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">nmrformd</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nmrmd</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>From the trajectory files, let us create a MDAnalysis universe.
Import the configuration file and the trajectory:</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">datapath</span><span class="o">+</span><span class="s2">&quot;init.data&quot;</span><span class="p">,</span> <span class="n">datapath</span><span class="o">+</span><span class="s2">&quot;prod.xtc&quot;</span><span class="p">)</span>
<span class="n">u</span><span class="o">.</span><span class="n">transfer_to_memory</span><span class="p">(</span><span class="n">stop</span><span class="o">=</span><span class="mi">501</span><span class="p">)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>The <em>u.transfer_to_memory(stop=501)</em>, is optional, it only serve to
reduce the number of frames, and therefore reduce the duration of
the calculation. Feel free to remove it, or increase its value.
The figures here have been generated using the
full trajectory (i.e. without the <em>transfer_to_memory</em> command).</p>
</div>
<div class="justify docutils container">
<p>The MDAnalysis universe <em>u</em> contains both topology (atoms types, masses, etc.)
and trajectory (atom positions at every frame).</p>
</div>
<div class="justify docutils container">
<p>Let us extract a few information from the universe,
such as number of molecules (water + PEG), timestep, and total duration:</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n_molecules</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">n_residues</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The number of molecules is </span><span class="si">{</span><span class="n">n_molecules</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>&gt;&gt; The number of molecules is 352
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">timestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The timestep is </span><span class="si">{</span><span class="n">timestep</span><span class="si">}</span><span class="s2"> ps&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>&gt;&gt; The timestep is 1 ps
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">total_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">totaltime</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The total simulation time is </span><span class="si">{</span><span class="n">total_time</span><span class="si">}</span><span class="s2"> ps&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>&gt;&gt; The total simulation time is 1000 ps
</pre></div>
</div>
<div class="justify docutils container">
<p>Note that in the context of MDAnalysis,
the <em>timestep</em> refers to the duration
between two recorded frames, which is different from the actual
timestep of <span class="math notranslate nohighlight">\(1\,\text{fs}\)</span> used for the LAMMPS
molecular dynamics simulation.</p>
</div>
</section>
<section id="launch-the-nmr-analysis">
<h2>Launch the NMR analysis<a class="headerlink" href="#launch-the-nmr-analysis" title="Link to this heading">¶</a></h2>
<div class="justify docutils container">
<p>Let us create 3 atom groups for respectively the hydrogen
atoms of the PEG, the hydrogen
atoms of the water, and all the hydrogen atoms:</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">H_PEG</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;type 3 5&quot;</span><span class="p">)</span>
<span class="n">H_H2O</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;type 7&quot;</span><span class="p">)</span>
<span class="n">H_ALL</span> <span class="o">=</span> <span class="n">H_PEG</span> <span class="o">+</span> <span class="n">H_H2O</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Then, let us run NMRforMD for all the hydrogen atoms:</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nmr_ALL</span> <span class="o">=</span> <span class="n">nmrmd</span><span class="o">.</span><span class="n">NMR</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">atom_group</span> <span class="o">=</span> <span class="n">H_ALL</span><span class="p">,</span> <span class="n">neighbor_group</span> <span class="o">=</span> <span class="n">H_ALL</span><span class="p">,</span> <span class="n">number_i</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>With ‘number_i = 40’, only 40 randomly selected atoms within ‘H_ALL’ are
considered for the calculation. Increase this number for better resolution,
and use ‘number_i = 0’ to consider all the atoms.</p>
</div>
</section>
<section id="extract-the-nmr-spectra">
<h2>Extract the NMR spectra<a class="headerlink" href="#extract-the-nmr-spectra" title="Link to this heading">¶</a></h2>
<div class="justify docutils container">
<p>Let us access the calculated value of the NMR relaxation time <span class="math notranslate nohighlight">\(T_1\)</span>:</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">nmr_ALL</span><span class="o">.</span><span class="n">T1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The total NMR relaxation time is T1 = </span><span class="si">{</span><span class="n">T1</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>&gt;&gt; NMR relaxation time T1 = 2.53 s
</pre></div>
</div>
<div class="justify docutils container">
<p>The value you obtain may vary, depending on which hydrogen atoms
were randomly selected for the calculation.</p>
</div>
<div class="justify docutils container">
<p>The full <span class="math notranslate nohighlight">\(T_1\)</span> and <span class="math notranslate nohighlight">\(T_2\)</span> spectra can be extracted as well
as 1/nmr_ALL.R1 and 1/nmr_ALL.R2, respectively,
and the corresponding frequency is given by nmr_ALL.f.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">R1_spectrum</span> <span class="o">=</span> <span class="n">nmr_ALL</span><span class="o">.</span><span class="n">R1</span>
<span class="n">R2_spectrum</span> <span class="o">=</span> <span class="n">nmr_ALL</span><span class="o">.</span><span class="n">R2</span>
<span class="n">T1_spectrum</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">R1_spectrum</span>
<span class="n">T2_spectrum</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">R2_spectrum</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">nmr_ALL</span><span class="o">.</span><span class="n">f</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>The spectra <span class="math notranslate nohighlight">\(T_1\)</span> and <span class="math notranslate nohighlight">\(T_2\)</span> can then be
plotted as a function of <span class="math notranslate nohighlight">\(f\)</span> using pyplot.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">T1_spectrum</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">T2_spectrum</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="NMR results obtained from the LAMMPS simulation of water" class="only-dark" src="../_images/T1-dark.png" />
<img alt="NMR results obtained from the LAMMPS simulation of water" class="only-light" src="../_images/T1-light.png" />
<div class="figurelegend docutils container">
<p>Figure: NMR relaxation times <span class="math notranslate nohighlight">\(T_1\)</span> (disks) and
<span class="math notranslate nohighlight">\(T_2\)</span> (squares) as a function
of the frequency <span class="math notranslate nohighlight">\(f\)</span> for
the <span class="math notranslate nohighlight">\(\text{PEG-H}_2\text{O}\)</span> bulk mixture.</p>
</div>
</section>
<section id="calculate-the-intra-molecular-nmr-relaxation">
<h2>Calculate the intra-molecular NMR relaxation<a class="headerlink" href="#calculate-the-intra-molecular-nmr-relaxation" title="Link to this heading">¶</a></h2>
<div class="justify docutils container">
<p>Let us measuring the intra-molecular contribution to the NMR
relaxation time measurement. To make the analysis easier,
let us also differentiate between PEG and <span class="math notranslate nohighlight">\(\text{H}_2\text{O}\)</span>
molecule, and perform 2 separate analyses.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nmr_H2O_intra</span> <span class="o">=</span> <span class="n">nmrmd</span><span class="o">.</span><span class="n">NMR</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">atom_group</span> <span class="o">=</span> <span class="n">H_H2O</span><span class="p">,</span> <span class="n">type_analysis</span><span class="o">=</span><span class="s2">&quot;intra_molecular&quot;</span><span class="p">,</span> <span class="n">number_i</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">nmr_PEG_intra</span> <span class="o">=</span> <span class="n">nmrmd</span><span class="o">.</span><span class="n">NMR</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">atom_group</span> <span class="o">=</span> <span class="n">H_PEG</span><span class="p">,</span> <span class="n">type_analysis</span><span class="o">=</span><span class="s2">&quot;intra_molecular&quot;</span><span class="p">,</span> <span class="n">number_i</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>The correlation function Gij can be accessed from nmr_H2O_intra.gij[0],
and the time  from nmr_H2O_intra.t.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">nmr_PEG_intra</span><span class="o">.</span><span class="n">t</span>
<span class="n">G_intra_H2O</span> <span class="o">=</span> <span class="n">nmr_H2O_intra</span><span class="o">.</span><span class="n">gij</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">G_intra_PEG</span> <span class="o">=</span> <span class="n">nmr_PEG_intra</span><span class="o">.</span><span class="n">gij</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<img alt="NMR results obtained from the LAMMPS simulation of water-PEG" class="only-dark" src="../_images/Gintra-dark.png" />
<img alt="NMR results obtained from the LAMMPS simulation of water-PEG" class="only-light" src="../_images/Gintra-light.png" />
<div class="figurelegend docutils container">
<p>Figure: Intra-molecular correlation function <span class="math notranslate nohighlight">\(G_\text{R}\)</span>
for both PEG (squares) and <span class="math notranslate nohighlight">\(\text{H}_2\text{O}\)</span> (disks).</p>
</div>
<div class="justify docutils container">
<p>From the correlation functions, one can obtain the typical
rotational time of the molecules.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tau_rot_H2O</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">G_intra_H2O</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="n">G_intra_H2O</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
<span class="n">tau_rot_PEG</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">G_intra_PEG</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="n">G_intra_PEG</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The rotational time of H2O is = </span><span class="si">{</span><span class="n">tau_rot_H2O</span><span class="si">}</span><span class="s2"> ps&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The rotational time of PEG is = </span><span class="si">{</span><span class="n">tau_rot_PEG</span><span class="si">}</span><span class="s2"> ps&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>&gt;&gt; The rotational time of H2O is = 6.35 ps
&gt;&gt; The rotational time of PEG is = 8.34 ps
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="anisotropic-system.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Anisotropic systems</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="installation.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Installation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; All source code is available under the GNU General Public License v3.0
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Isotropic systems</a><ul>
<li><a class="reference internal" href="#md-system">MD system</a></li>
<li><a class="reference internal" href="#file-preparation">File preparation</a></li>
<li><a class="reference internal" href="#create-a-mdanalysis-universe">Create a MDAnalysis universe</a></li>
<li><a class="reference internal" href="#launch-the-nmr-analysis">Launch the NMR analysis</a></li>
<li><a class="reference internal" href="#extract-the-nmr-spectra">Extract the NMR spectra</a></li>
<li><a class="reference internal" href="#calculate-the-intra-molecular-nmr-relaxation">Calculate the intra-molecular NMR relaxation</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=a58bc63e"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>